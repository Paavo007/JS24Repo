<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <link rel="stylesheet" href="laskin.css">
</head>
<body>
    <div class="container">
        <div class="display">
            <input id="screen" type="text" placeholder="0">
        </div>
        <div class="btns">
            <div class="row">
                <button id="ce" onclick="backspc()">CE</button>
                <button onclick="fact()">x!</button>
                <button class="btn" onclick="openParenthesis()">(</button>
                <button class="btn" onclick="closeParenthesis()">)</button>
                <button class="btn">%</button>
                <button id="ac" onclick="screen.value = ''">AC</button>
            </div>

            <div class="row">
                <button onclick="sin()">sin</button>
                <button onclick="pi()">π</button>
                <button class="btn">7</button>
                <button class="btn">8</button>
                <button class="btn">9</button>
                <button class="btn">÷</button>
            </div>

            <div class="row">
                <button onclick="cos()">cos</button>
                <button onclick="log()">log</button>
                <button class="btn">4</button>
                <button class="btn">5</button>
                <button class="btn">6</button>
                <button class="btn" onclick="multiply()">x</button>
            </div>

            <div class="row">
                <button onclick="tan()">tan</button>
                <button onclick="sqrt()">√</button>
                <button class="btn">1</button>
                <button class="btn">2</button>
                <button class="btn">3</button>
                <button class="btn" onclick="subtract()">-</button>
            </div>

            <div class="row">
                <button onclick="e()">e</button>
                <button onclick="pow()">x <span style="position: relative; bottom: .4em; right: .1em;">y</span></button>
                <button class="btn">0</button>
                <button class="btn">.</button>
                <button id="eval" onclick="evaluateExpression()">=</button>
                <button class="btn" onclick="add()">+</button>
            </div>
        </div>
    </div>
</body>
<script>
    var screen = document.querySelector('#screen');
    var btn = document.querySelectorAll('.btn');

    for(item of btn) {
        item.addEventListener('click',(e)=> {
            btnText = e.target.innerText;

            if(btnText == 'x'){
                btnText = '*';
            }

            if(btnText == '÷') {
                btnText = '/';
            }

            screen.value += btnText;
        });
    }

    function sin() {
        screen.value += 'sin('; // Append sin(
    }

    function cos() {
        screen.value += 'cos('; // Append cos(
    }

    function tan() {
        screen.value += 'tan('; // Append tan(
    }

    function log() {
        screen.value += 'log('; // Append log(
    }

    function pow() {
        screen.value += '^'; // Append ^ for exponent
    }

    function fact() {
        screen.value += 'fact('; // Append fact(
    }

    function sqrt() {
        screen.value += 'sqrt('; // Append sqrt(
    }

    function multiply() {
        screen.value += '*'; // Append * for multiplication
    }

    function subtract() {
        screen.value += '-'; // Append - for subtraction
    }

    function add() {
        screen.value += '+'; // Append + for addition
    }

    function openParenthesis() {
        screen.value += '('; // Append ( for opening parenthesis
    }

    function closeParenthesis() {
        screen.value += ')'; // Append ) for closing parenthesis
    }

    function pi() {
        screen.value += '3.14159265358979323846'; // Append the value of π
    }

    function e() {
        screen.value += '2.71828182845904523536'; // Append the value of e
    }

    function backspc() {
        screen.value = screen.value.substr(0, screen.value.length-1);
    }

    function evaluateExpression() {
        // Evaluate the functions correctly
        const expr = screen.value
            .replace(/sin\(([^)]+)\)/g, function(match, p1) {
                return Math.sin(p1);
            })
            .replace(/cos\(([^)]+)\)/g, function(match, p1) {
                return Math.cos(p1);
            })
            .replace(/tan\(([^)]+)\)/g, function(match, p1) {
                return Math.tan(p1);
            })
            .replace(/log\(([^)]+)\)/g, function(match, p1) {
                return Math.log(p1);
            })
            .replace(/sqrt\(([^)]+)\)/g, function(match, p1) {
                return Math.sqrt(p1);
            })
            .replace(/fact\(([^)]+)\)/g, function(match, p1) {
                return factorial(p1);
            });

        screen.value = eval(expr); // Evaluate the final expression
    }

    function factorial(n) {
        n = parseInt(n);
        if (n < 0) return NaN; // Factorial is not defined for negative numbers
        if (n === 0) return 1; // 0! is 1
        let f = 1;
        for (let i = 1; i <= n; i++) {
            f *= i;
        }
        return f;
    }
</script>
</html>
